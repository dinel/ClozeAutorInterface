{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('css/cloze.css') }}" rel="stylesheet">
{% endblock %}

{% block body %}
    <div class="container">
        <div class="row voffset4">
            <div class="col-md-8">                                                
                <div class="voffset4" id="results">
                    {% set counter = 0 %}
                    {% for word in text %}
                        {% if word starts with "[" %}
                            <span class="answer 
                            {% if filled[counter] == counter %}
                                correct-answer
                            {% else %}
                                wrong-answer
                            {% endif %}
                                ">{{ word[1:-1]|raw }}</span>
                            {% set counter = counter + 1 %}
                        {% else %}
                            <span>{{ word|raw }}</span>
                        {% endif %}
                    {% endfor %}
                    
                    <div class="voffset4 text-center">
                        <a id="try-again" class="btn btn-default" role="button">Try again &raquo;</a>
                    </div>
                </div>
                                                                                
                <div class="voffset4" id="text">
                    <h3>Try to fill in the gaps using the words from the right</h3>
                    {% set counter = 0 %}
                    {% set no_gaps = 0 %}
                    {% for word in text %}
                        {% if word starts with "[" %}
                            {% if filled[counter] == counter %}
                                <span>{{ word[1:-1]|raw }}</span>
                            {% else %}
                                <div id="gap{{ no_gaps }}" ondrop="drop(event)" ondragover="allowDrop(event)" class="gap">&nbsp;</div>
                                {% set no_gaps = no_gaps + 1 %}
                            {% endif %}
                            {% set counter = counter + 1 %}
                        {% else %}
                            <span>{{ word|raw }}</span>                             
                        {% endif %}
                    {% endfor %}
                
                    <div class="voffset5 text-center">
                        <a id="submit-result" class="btn btn-default disabled" role="button">Check again &raquo;</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">                
                <div data-spy="affix" id="words">
                    {% set counter = 0 %}
                    {% set no_gaps = 0 %}
                    {% for word in the_correct_text %}
                        {% if word starts with "[" %}
                            {% if filled[counter] != counter %}
                                <div id="word{{ no_gaps }}" ondragstart="drag(event)" 
                                        class="filler filler-in-list" draggable="true">{{ word[1:-1] }}</div>
                                {% set no_gaps = no_gaps + 1 %}
                            {% endif %}
                            {% set counter = counter + 1 %}
                        {% endif %}                    
                    {% endfor %}          
                </div>
                
                <script>
                    var no_gaps = {{ no_gaps }};
                    var filled_gaps = 0;     
                    var redirection = "feedback";                    
                </script>
                
            </div>
        </div>
    </div>                
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/cloze.js') }}"></script>
{% endblock %}